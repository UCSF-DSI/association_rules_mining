parameter = list(supp=0.005, target="frequent itemsets")
)
frequent_itemsets <- inspect(frequent_itemsets) %>%
arrange(desc(support))
frequent_itemsets
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, target="rules")
)
rules <- inspect(rules) %>%
filter(lift >= 1) %>%
arrange(desc(lift))
rules
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, target="rules")
)
as(prescriptions_df$RXDDRGID, "transactions")
# Load data from NHANES into prescriptions_df
prescriptions_df <- read_xpt("https://wwwn.cdc.gov/Nchs/Nhanes/2017-2018/RXQ_RX_J.XPT")
# Filter to prescriptions that were taken in the last month
# Select patients (SEQN) and drug codes (RXDDRGID)
prescriptions_df <- prescriptions_df %>%
filter(RXDUSE == 1) %>%
select(SEQN, RXDDRGID)
# View dataframe
prescriptions_df
prescriptions_df <- prescriptions_df %>%
filter(RXDDRGID != "") %>%
group_by(SEQN) %>%
summarize(RXDDRGID = list(unique(RXDDRGID)))
prescriptions_df
frequent_itemsets <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, target="frequent itemsets")
)
frequent_itemsets <- inspect(frequent_itemsets) %>%
arrange(desc(support))
frequent_itemsets
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, target="rules")
)
rules <- inspect(rules) %>%
filter(lift >= 1) %>%
arrange(desc(lift))
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005)
)
rules <- inspect(rules) %>%
filter(lift >= 1) %>%
arrange(desc(lift))
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions")
)
rules <- inspect(rules) %>%
filter(lift >= 1) %>%
arrange(desc(lift))
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules <- inspect(rules) %>%
filter(lift >= 1) %>%
arrange(desc(lift))
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules <- inspect(rules) %>%
arrange(desc(lift))
rules
inspect(rules)
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules = data.frame(
antecedents = labels(lhs(rules))$elements,
consequents = labels(rhs(rules))$elements,
rules@quality
)
labels(lhs(rules))$elements
labels(lhs(rules))
lhs(rules)
labels
labels(lhs(rules))
rules
inspect(rules)
inspect(rules)['lhs']
inspect(rules)["lhs"]
inspect(rules)["lhs"]$elements
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules = data.frame(
antecedents = inspect(rules)["lhs"],
consequents = inspect(rules)["rhs"]
)
rules
inspect(rules)["lhs"]
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
inspect(rules)
rules@quality
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules = data.frame(
antecedents = inspect(rules)["lhs"],
consequents = inspect(rules)["rhs"],
rules@quality
)
rules
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules = data.frame(
antecedents = inspect(rules)["lhs"],
consequents = inspect(rules)["rhs"],
rules@quality
)
rules
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules <-  data.frame(
antecedents = inspect(rules)["lhs"],
consequents = inspect(rules)["rhs"],
rules@quality
)
rules <- rules %>%
filter(lift >= 1)
rules
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules <-  data.frame(
antecedents = inspect(rules)["lhs"],
consequents = inspect(rules)["rhs"],
rules@quality
)
rules <- rules %>%
filter(
lift >= 1,
lhs != '{}'
)
rules
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules <-  data.frame(
antecedents = inspect(rules)["lhs"],
consequents = inspect(rules)["rhs"],
rules@quality
)
rules <- rules %>%
filter(
lift >= 1,
lhs != "{}",
rhs != "{}"
)
rules
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules <-  data.frame(
antecedents = inspect(rules)["lhs"],
consequents = inspect(rules)["rhs"],
rules@quality
)
rules <- rules %>%
filter(
lift >= 1,
lhs != "{}",
rhs != "{}"
) %>%
arrange(desc(lift))
rules
drugs_df = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/1999-2000/RXQ_DRUG.xpt', encoding='UTF-8')
drugs_df = read_xpt("https://wwwn.cdc.gov/Nchs/Nhanes/1999-2000/RXQ_DRUG.xpt")
drugs_df <- drugs_df %>%
select(RXDDRGID, RXDDRUG) %>%
column_to_rownames(var=RXDDRGID)
drugs_df = read_xpt("https://wwwn.cdc.gov/Nchs/Nhanes/1999-2000/RXQ_DRUG.xpt")
drugs_df <- drugs_df %>%
select(RXDDRGID, RXDDRUG) %>%
column_to_rownames(var="RXDDRGID")
# View dataframe
drugs_df
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules <-  data.frame(
antecedents = inspect(rules)["lhs"],
consequents = inspect(rules)["rhs"],
rules@quality
)
rules <- rules %>%
filter(
lift >= 1,
antecedents != "{}",
consequents != "{}"
) %>%
arrange(desc(lift))
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules <-  data.frame(
antecedents = inspect(rules)["lhs"],
consequents = inspect(rules)["rhs"],
rules@quality
)
rules <- rules %>%
filter(
lift >= 1,
lhs != "{}",
rhs != "{}"
) %>%
arrange(desc(lift))
rules
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules <-  data.frame(
inspect(rules)["lhs"],
inspect(rules)["rhs"],
rules@quality
)
rules <- rules %>%
filter(
lift >= 1,
lhs != "{}",
rhs != "{}"
) %>%
arrange(desc(lift))
rules
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules <-  data.frame(rules)
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules <-  data.frame(inspect(rules))
rules <- rules %>%
filter(
lift >= 1,
lhs != "{}",
rhs != "{}"
) %>%
arrange(desc(lift))
rules
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules <-data.frame(inspect(rules)) %>%
filter(
lift >= 1,
lhs != "{}",
rhs != "{}"
) %>%
arrange(desc(lift))
rules
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules <-data.frame(inspect(rules)) %>%
filter(
lift >= 1,
lhs != "{}",
rhs != "{}"
) %>%
select(-Var.2) %>%
arrange(desc(lift))
rules
rules <- rules %>%
mutate(
lhs = list(strsplit(lhs, split=","))
rhs = list(strsplit(rhs, split=","))
rules <- rules %>%
mutate(
lhs = list(strsplit(lhs, split=",")),
rhs = list(strsplit(rhs, split=","))
)
rules
rules <- rules %>%
mutate(
lhs = list(strsplit(lhs, split=",")),
rhs = list(strsplit(rhs, split=","))
)
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules <-data.frame(inspect(rules)) %>%
filter(
lift >= 1,
lhs != "{}",
rhs != "{}"
) %>%
select(-Var.2) %>%
arrange(desc(lift))
rules
rules <- rules %>%
mutate(
lhs = list(strsplit(lhs, split=",")),
rhs = list(strsplit(rhs, split=","))
)
rules
rules <- apriori(
as(prescriptions_df$RXDDRGID, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules <-data.frame(inspect(rules)) %>%
filter(
lift >= 1,
lhs != "{}",
rhs != "{}"
) %>%
select(-Var.2) %>%
arrange(desc(lift))
rules
rules <- rules %>%
mutate(
lhs = strsplit(lhs, split=","),
rhs = strsplit(rhs, split=",")
)
rules
rules
rules <- rules %>%
mutate(
lhs = strsplit(lhs, split=","),
rhs = strsplit(rhs, split=",")
)
rules
prescriptions_df <- prescriptions_df <- %>%
# Load data from NHANES into prescriptions_df
prescriptions_df <- read_xpt("https://wwwn.cdc.gov/Nchs/Nhanes/2017-2018/RXQ_RX_J.XPT")
# Filter to prescriptions that were taken in the last month
# Select patients (SEQN) and drug codes (RXDDRGID)
prescriptions_df <- prescriptions_df %>%
filter(RXDUSE == 1) %>%
select(SEQN, RXDDRGID)
# View dataframe
prescriptions_df
{r drug_names}
drugs_df = read_xpt("https://wwwn.cdc.gov/Nchs/Nhanes/1999-2000/RXQ_DRUG.xpt")
drugs_df <- drugs_df %>%
select(RXDDRGID, RXDDRUG) %>%
column_to_rownames(var="RXDDRGID")
# View dataframe
drugs_df
prescriptions_df <- prescriptions_df <- %>%
prescriptions_df <- prescriptions_df %>%
mutate(RXDDRGID = drugs_df[RXDDRGID, "RXXDRUG"])
# Load data from NHANES into prescriptions_df
prescriptions_df <- read_xpt("https://wwwn.cdc.gov/Nchs/Nhanes/2017-2018/RXQ_RX_J.XPT")
# Filter to prescriptions that were taken in the last month
# Select patients (SEQN) and drug codes (RXDDRGID)
prescriptions_df <- prescriptions_df %>%
filter(RXDUSE == 1) %>%
select(SEQN, RXDDRGID)
# View dataframe
prescriptions_df
prescriptions_df <- prescriptions_df %>%
mutate(RXDDRGID = drugs_df[RXDDRGID, "RXXDRUG"])
prescriptions_df
# Load data from NHANES into prescriptions_df
prescriptions_df <- read_xpt("https://wwwn.cdc.gov/Nchs/Nhanes/2017-2018/RXQ_RX_J.XPT")
# Filter to prescriptions that were taken in the last month
# Select patients (SEQN) and drug name (RXXDRUG)
prescriptions_df <- prescriptions_df %>%
filter(RXDUSE == 1) %>%
select(SEQN, RXXDRUG)
# Load data from NHANES into prescriptions_df
prescriptions_df <- read_xpt("https://wwwn.cdc.gov/Nchs/Nhanes/2017-2018/RXQ_RX_J.XPT")
# Filter to prescriptions that were taken in the last month
# Select patients (SEQN) and drug name (RXXDRUG)
prescriptions_df <- prescriptions_df %>%
filter(RXDUSE == 1) %>%
select(SEQN, RXDDRUG)
# View dataframe
prescriptions_df
prescriptions_df <- prescriptions_df %>%
filter(RXDDRUG != "") %>%
group_by(SEQN) %>%
summarize(RXDDRUG = list(unique(RXDDRUG)))
prescriptions_df
frequent_itemsets <- apriori(
as(prescriptions_df$RXDDRUG, "transactions"),
parameter = list(supp=0.005, target="frequent itemsets")
)
frequent_itemsets <- inspect(frequent_itemsets) %>%
arrange(desc(support))
frequent_itemsets
rules <- apriori(
as(prescriptions_df$RXDDRUG, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules <-data.frame(inspect(rules)) %>%
filter(
lift >= 1,
lhs != "{}",
rhs != "{}"
) %>%
select(-Var.2) %>%
arrange(desc(lift))
rules
# Load data from NHANES into prescriptions_df
prescriptions_df <- read_xpt("https://wwwn.cdc.gov/Nchs/Nhanes/2017-2018/RXQ_RX_J.XPT")
# Filter to prescriptions that were taken in the last month
# Select patients (SEQN) and drug name (RXXDRUG)
prescriptions_df <- prescriptions_df %>%
filter(RXDUSE == 1) %>%
select(SEQN, RXDDRUG)
# View dataframe
prescriptions_df
prescriptions_df <- prescriptions_df %>%
filter(
RXDDRUG != "55555",
RXDDRUG != "77777",
RXDDRUG != "99999",
RXDDRUG != ""
) %>%
group_by(SEQN) %>%
summarize(RXDDRUG = list(unique(RXDDRUG)))
prescriptions_df
frequent_itemsets <- apriori(
as(prescriptions_df$RXDDRUG, "transactions"),
parameter = list(supp=0.005, target="frequent itemsets")
)
frequent_itemsets <- inspect(frequent_itemsets) %>%
arrange(desc(support))
frequent_itemsets
rules <- apriori(
as(prescriptions_df$RXDDRUG, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules <-data.frame(inspect(rules)) %>%
filter(
lift >= 1,
lhs != "{}",
rhs != "{}"
) %>%
select(-Var.2) %>%
arrange(desc(lift))
rules
as(prescriptions_df$RXDDRUG, "transactions")
packages <- c("arules", "arulesViz", "tidyverse", "haven", "fastDummies")
# Installing Packages
# install.packages(packages, update = TRUE, ask = FALSE)
# Loading Packages
for(package in packages) {
do.call("library", list(package))
}
# Load data from NHANES into prescriptions_df
prescriptions_df <- read_xpt("https://wwwn.cdc.gov/Nchs/Nhanes/2017-2018/RXQ_RX_J.XPT")
# Filter to prescriptions that were taken in the last month
# Select patients (SEQN) and drug name (RXXDRUG)
prescriptions_df <- prescriptions_df %>%
filter(RXDUSE == 1) %>%
select(SEQN, RXDDRUG)
# View dataframe
prescriptions_df
prescriptions_df <- prescriptions_df %>%
filter(
RXDDRUG != "55555",
RXDDRUG != "77777",
RXDDRUG != "99999",
RXDDRUG != ""
) %>%
group_by(SEQN) %>%
summarize(RXDDRUG = list(unique(RXDDRUG)))
prescriptions_df
frequent_itemsets <- apriori(
as(prescriptions_df$RXDDRUG, "transactions"),
parameter = list(supp=0.005, target="frequent itemsets")
)
frequent_itemsets <- inspect(frequent_itemsets) %>%
arrange(desc(support))
frequent_itemsets
rules <- apriori(
as(prescriptions_df$RXDDRUG, "transactions"),
parameter = list(supp=0.005, conf=0.005, target="rules")
)
rules <-data.frame(inspect(rules)) %>%
filter(
lift >= 1,
lhs != "{}",
rhs != "{}"
) %>%
select(-Var.2) %>%
arrange(desc(lift))
rules
